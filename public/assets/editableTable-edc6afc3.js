import{Y as E,aN as K,r as f,j as o,d as C,aK as c,e as b,aM as x,a as k,t as q,i as I,B as N}from"./index-d9b286db.js";import"./index-3e8a6381.js";import{T as R}from"./index-b8adce3c.js";import{d as T}from"./service-0a2c8592.js";import{P as j}from"./pictureUpload-8a2d544a.js";import"./index-e84d0038.js";import"./index.browser-7e542916.js";const G=({detailData:s,setDetailData:r,setSelectedRow:y,selectedRow:h})=>{const{data:u}=E(()=>K("CATEGORY")),S=[{title:"品名",dataIndex:"category",align:"center",width:160,render:(n,e,a)=>o(C,{disabled:e.status===1,placeholder:"请选择品名",allowClear:!0,value:e.category,onChange:(t,l)=>{const d=m.filter(w=>w!==e.nanoid),g=h.filter(w=>w.nanoid!==e.nanoid);p(d),y(g);const i=c.cloneDeep(s);t?(i[a].category=t,i[a].categoryName="children"in l?l.children:""):(i[a].category="",i[a].categoryName=""),r(i)},children:u==null?void 0:u.map(t=>o(C.Option,{value:t.key,children:t.title},t.id))})},{title:"款号",dataIndex:"styleCode",align:"center",width:220,render:(n,e,a)=>o(b,{disabled:e.status===1,value:e.styleCode,onChange:t=>{const l=c.cloneDeep(s);l[a].styleCode=t,r(l)}})},{title:"图片",dataIndex:"imgSrc",align:"center",render:(n,e,a)=>o(j,{url:e.imgSrc,onChange:t=>{var d,g;const l=c.cloneDeep(s);l[a].imgSrc=(g=(d=t[0])==null?void 0:d.response)==null?void 0:g.src,r(l)}})},{title:"圈号",dataIndex:"circle",align:"center",width:100,render:(n,e,a)=>o(b,{disabled:e.status===1,value:e.circle,onChange:t=>{const l=c.cloneDeep(s);l[a].circle=t,r(l)}})},{title:"件重",dataIndex:"singleWeight",align:"center",width:100,render:(n,e,a)=>o(x,{disabled:e.status===1,value:e.singleWeight,onChange:t=>{const l=c.cloneDeep(s);l[a].singleWeight=t,r(l)}})},{title:"数量",dataIndex:"quantity",align:"center",width:100,render:(n,e,a)=>o(x,{disabled:e.status===1,value:e.quantity,onChange:t=>{const l=c.cloneDeep(s);l[a].quantity=t,r(l)}})},{title:"状态",align:"center",dataIndex:"status",width:100,render:n=>k(q,{children:[n===0&&o(I,{color:"red",children:"未排产"}),n===1&&o(I,{color:"green",children:"已排产"})]})},{title:"操作",align:"center",width:120,render:(n,e,a)=>o(N,{disabled:e.status===1,type:"text",onClick:()=>v(e.id,a),children:"删除"})}],v=async(n,e)=>{n&&await T(n),r(s.filter((a,t)=>t!==e))},[m,p]=f.useState([]);return f.useEffect(()=>{p(h.map(n=>n.nanoid))},[h]),o(R,{scroll:{y:window.screen.height-300},columns:S,data:s,pagination:!1,rowKey:"nanoid",rowSelection:{type:"checkbox",selectedRowKeys:m,onChange:(n,e)=>{p(n),y(e)},checkboxProps:n=>({disabled:!n.category||n.status===1})}})};export{G as default};
